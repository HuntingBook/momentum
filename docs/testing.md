# 测试计划 (Test Plan)

## 1. 测试策略

本项目采用 **分层测试** 策略，涵盖单元测试、集成测试和用户验收测试 (UAT)。

### 1.1 测试范围
- **后端 API**: 核心业务逻辑（回测算法、筛选逻辑、数据同步）。
- **前端 UI**: 交互流程（表单提交、图表渲染、加载状态反馈）。
- **数据完整性**: 确保 AKShare 数据源同步后的数据准确性。

## 2. 单元测试 (Unit Testing)

### 2.1 后端测试
框架：`pytest`
位置：`backend/tests/`

重点测试各 Service 模块：
- **Backtest Service**: 验证 `ma_cross` 等策略算法在已知 K 线数据下的收益计算是否正确。
- **Screening Service**: 验证 SQL 查询生成器能否正确处理 `min_pe`, `max_market_cap` 等过滤条件。
- **Pattern Service**: 验证形态识别算法对特定 K 线组合（如三连阳）的识别准确率。

运行命令：
```bash
cd backend
pytest
```

### 2.2 前端测试
目前侧重于组件渲染测试。
- 验证 `Modal` 组件能否正确挂载到 `document.body`。
- 验证 `Loading` 组件的显隐状态。

## 3. 集成测试 (Integration Testing)

### 3.1 API 接口测试
使用 Postman 或自动化脚本测试关键流程：
1. **数据同步流程**: 调用 `/data/sync/daily` -> 查询 `/stocks` 确认 `updated_at` 字段更新。
2. **筛选流程**: 保存预设 -> 获取预设列表 -> 加载预设 -> 验证筛选结果。
3. **回测流程**: 提交回测任务 -> 轮询/等待结果 -> 验证返回的 `equity_curve` 数据格式。

### 3.2 端到端测试 (E2E)
人工手动测试以下核心路径：
1. **用户登录**: 验证 Token 获取与失效处理（目前模拟登录）。
2. **选股操作**: 在前端页面组合条件，点击筛选，验证表格数据加载及分页功能。
3. **交互反馈**: 断网或模拟 500 错误时，验证 Toat 提示及按钮 Loading 状态恢复。

## 4. 用户验收测试 (UAT)

### 验证场景
- **场景 A (新手引导)**: 用户首次进入，能否直观理解 Dashboard 核心数据含义。
- **场景 B (日常复盘)**: 用户进行 "日线同步" -> "形态扫描" -> "查看结果" 流程的流畅度。
- **场景 C (策略研究)**: 用户配置自定义参数回测，对比不同参数下的收益率变化。

### 验收标准
1. 所有核心功能（同步、筛选、回测）在正常网络下响应时间 < 2秒（同步任务除外）。
2. 页面无明显布局错乱，深色/浅色模式切换正常。
3. 导出 CSV 功能生成的表格数据与页面显示一致。
